#include <math.h>
#include "synth.h"

const int32_t tanhtab[] = {
65536,0,65533,65536,65530,131069,65524,196599,65515,262123,
65506,327638,65494,393144,65479,458638,65464,524117,65446,589581,
65426,655027,65404,720453,65379,785857,65354,851236,65327,916590,
65296,981917,65264,1047213,65231,1112477,65195,1177708,65157,1242903,
65117,1308060,65076,1373177,65032,1438253,64987,1503285,64939,1568272,
64890,1633211,64839,1698101,64786,1762940,64730,1827726,64673,1892456,
64615,1957129,64553,2021744,64491,2086297,64426,2150788,64360,2215214,
64292,2279574,64222,2343866,64149,2408088,64076,2472237,64000,2536313,
63923,2600313,63843,2664236,63762,2728079,63680,2791841,63595,2855521,
63508,2919116,63421,2982624,63330,3046045,63239,3109375,63145,3172614,
63051,3235759,62953,3298810,62856,3361763,62755,3424619,62653,3487374,
62550,3550027,62444,3612577,62338,3675021,62229,3737359,62120,3799588,
62007,3861708,61895,3923715,61780,3985610,61663,4047390,61546,4109053,
61426,4170599,61305,4232025,61183,4293330,61059,4354513,60934,4415572,
60806,4476506,60678,4537312,60549,4597990,60417,4658539,60285,4718956,
60151,4779241,60015,4839392,59878,4899407,59741,4959285,59601,5019026,
59460,5078627,59318,5138087,59174,5197405,59030,5256579,58884,5315609,
58737,5374493,58589,5433230,58438,5491819,58288,5550257,58136,5608545,
57983,5666681,57828,5724664,57673,5782492,57516,5840165,57359,5897681,
57199,5955040,57040,6012239,56879,6069279,56717,6126158,56553,6182875,
56390,6239428,56224,6295818,56059,6352042,55891,6408101,55724,6463992,
55554,6519716,55385,6575270,55214,6630655,55042,6685869,54870,6740911,
54696,6795781,54523,6850477,54347,6905000,54171,6959347,53995,7013518,
53817,7067513,53640,7121330,53460,7174970,53280,7228430,53101,7281710,
52919,7334811,52737,7387730,52555,7440467,52372,7493022,52189,7545394,
52004,7597583,51819,7649587,51633,7701406,51448,7753039,51261,7804487,
51073,7855748,50886,7906821,50698,7957707,50509,8008405,50320,8058914,
50130,8109234,49941,8159364,49749,8209305,49559,8259054,49367,8308613,
49175,8357980,48984,8407155,48791,8456139,48598,8504930,48404,8553528,
48212,8601932,48017,8650144,47824,8698161,47629,8745985,47434,8793614,
47240,8841048,47044,8888288,46849,8935332,46654,8982181,46457,9028835,
46262,9075292,46066,9121554,45869,9167620,45674,9213489,45476,9259163,
45280,9304639,45084,9349919,44886,9395003,44690,9439889,44493,9484579,
44295,9529072,44099,9573367,43902,9617466,43704,9661368,43508,9705072,
43310,9748580,43114,9791890,42916,9835004,42720,9877920,42522,9920640,
42326,9963162,42129,10005488,41932,10047617,41736,10089549,41540,10131285,
41343,10172825,41147,10214168,40950,10255315,40755,10296265,40560,10337020,
40363,10377580,40169,10417943,39973,10458112,39778,10498085,39584,10537863,
39389,10577447,39195,10616836,39001,10656031,38807,10695032,38614,10733839,
38420,10772453,38228,10810873,38035,10849101,37842,10887136,37651,10924978,
37458,10962629,37268,11000087,37076,11037355,36886,11074431,36695,11111317,
36505,11148012,36316,11184517,36127,11220833,35937,11256960,35749,11292897,
35561,11328646,35373,11364207,35186,11399580,34999,11434766,34813,11469765,
34627,11504578,34441,11539205,34256,11573646,34071,11607902,33887,11641973,
33704,11675860,33520,11709564,33337,11743084,33155,11776421,32974,11809576,
32791,11842550,32611,11875341,32431,11907952,32251,11940383,32072,11972634,
31892,12004706,31715,12036598,31537,12068313,31359,12099850,31183,12131209,
31007,12162392,30831,12193399,30657,12224230,30481,12254887,30308,12285368,
30135,12315676,29962,12345811,29790,12375773,29618,12405563,29447,12435181,
29277,12464628,29107,12493905,28937,12523012,28769,12551949,28601,12580718,
28434,12609319,28266,12637753,28101,12666019,27934,12694120,27770,12722054,
27606,12749824,27441,12777430,27279,12804871,27116,12832150,26954,12859266,
26793,12886220,26632,12913013,26472,12939645,26313,12966117,26154,12992430,
25997,13018584,25838,13044581,25682,13070419,25526,13096101,25370,13121627,
25215,13146997,25062,13172212,24907,13197274,24755,13222181,24603,13246936,
24451,13271539,24300,13295990,24150,13320290,24000,13344440,23851,13368440,
23703,13392291,23555,13415994,23409,13439549,23262,13462958,23117,13486220,
22971,13509337,22827,13532308,22684,13555135,22540,13577819,22399,13600359,
22257,13622758,22115,13645015,21976,13667130,21835,13689106,21697,13710941,
21559,13732638,21421,13754197,21284,13775618,21147,13796902,21012,13818049,
20877,13839061,20743,13859938,20609,13880681,20476,13901290,20344,13921766,
20212,13942110,20081,13962322,19951,13982403,19821,14002354,19692,14022175,
19564,14041867,19436,14061431,19309,14080867,19183,14100176,19057,14119359,
18932,14138416,18807,14157348,18684,14176155,18561,14194839,18438,14213400,
18316,14231838,18196,14250154,18075,14268350,17955,14286425,17835,14304380,
17718,14322215,17599,14339933,17482,14357532,17365,14375014,17250,14392379,
17134,14409629,17019,14426763,16906,14443782,16791,14460688,16679,14477479,
16567,14494158,16455,14510725,16345,14527180,16234,14543525,16124,14559759,
16015,14575883,15907,14591898,15799,14607805,15692,14623604,15585,14639296,
15479,14654881,15373,14670360,15269,14685733,15165,14701002,15061,14716167,
14959,14731228,14856,14746187,14754,14761043,14653,14775797,14552,14790450,
14452,14805002,14353,14819454,14255,14833807,14156,14848062,14058,14862218,
13961,14876276,13865,14890237,13769,14904102,13674,14917871,13579,14931545,
13484,14945124,13392,14958608,13298,14972000,13205,14985298,13114,14998503,
13022,15011617,12932,15024639,12841,15037571,12752,15050412,12662,15063164,
12574,15075826,12486,15088400,12399,15100886,12311,15113285,12225,15125596,
12139,15137821,12054,15149960,11969,15162014,11885,15173983,11801,15185868,
11718,15197669,11635,15209387,11553,15221022,11471,15232575,11390,15244046,
11309,15255436,11230,15266745,11150,15277975,11070,15289125,10992,15300195,
10914,15311187,10837,15322101,10759,15332938,10683,15343697,10606,15354380,
10531,15364986,10456,15375517,10381,15385973,10307,15396354,10234,15406661,
10160,15416895,10087,15427055,10015,15437142,9944,15447157,9872,15457101,
9801,15466973,9731,15476774,9661,15486505,9591,15496166,9523,15505757,
9453,15515280,9386,15524733,9318,15534119,9251,15543437,9185,15552688,
9117,15561873,9052,15570990,8987,15580042,8922,15589029,8857,15597951,
8793,15606808,8729,15615601,8666,15624330,8603,15632996,8540,15641599,
8479,15650139,8417,15658618,8356,15667035,8295,15675391,8234,15683686,
8175,15691920,8115,15700095,8056,15708210,7998,15716266,7938,15724264,
7881,15732202,7824,15740083,7766,15747907,7710,15755673,7653,15763383,
7597,15771036,7541,15778633,7487,15786174,7431,15793661,7377,15801092,
7323,15808469,7269,15815792,7216,15823061,7163,15830277,7110,15837440,
7058,15844550,7005,15851608,6955,15858613,6903,15865568,6852,15872471,
6802,15879323,6752,15886125,6702,15892877,6653,15899579,6603,15906232,
6555,15912835,6506,15919390,6458,15925896,6411,15932354,6363,15938765,
6316,15945128,6269,15951444,6223,15957713,6177,15963936,6131,15970113,
6085,15976244,6041,15982329,5995,15988370,5951,15994365,5907,16000316,
5864,16006223,5819,16012087,5776,16017906,5734,16023682,5690,16029416,
5649,16035106,5606,16040755,5565,16046361,5523,16051926,5482,16057449,
5441,16062931,5401,16068372,5360,16073773,5321,16079133,5280,16084454,
5241,16089734,5203,16094975,5163,16100178,5124,16105341,5087,16110465,
5048,16115552,5011,16120600,4973,16125611,4936,16130584,4899,16135520,
4862,16140419,4826,16145281,4790,16150107,4753,16154897,4719,16159650,
4682,16164369,4648,16169051,4613,16173699,4578,16178312,4544,16182890,
4509,16187434,4476,16191943,4442,16196419,4409,16200861,4376,16205270,
4342,16209646,4310,16213988,4278,16218298,4246,16222576,4213,16226822,
4182,16231035,4150,16235217,4119,16239367,4088,16243486,4057,16247574,
4027,16251631,3996,16255658,3966,16259654,3936,16263620,3907,16267556,
3876,16271463,3848,16275339,3819,16279187,3789,16283006,3762,16286795,
3732,16290557,3705,16294289,3676,16297994,3649,16301670,3621,16305319,
3594,16308940,3566,16312534,3540,16316100,3512,16319640,3487,16323152,
3459,16326639,3434,16330098,3407,16333532,3382,16336939,3356,16340321,
3330,16343677,3306,16347007,3280,16350313,3255,16353593,3231,16356848,
3206,16360079,3182,16363285,3158,16366467,3133,16369625,3110,16372758,
3086,16375868,3063,16378954,3040,16382017,3016,16385057,2994,16388073,
2970,16391067,2948,16394037,2926,16396985,2904,16399911,2881,16402815,
2859,16405696,2838,16408555,2816,16411393,2795,16414209,2773,16417004,
2752,16419777,2732,16422529,2710,16425261,2690,16427971,2669,16430661,
2649,16433330,2629,16435979,2608,16438608,2589,16441216,2569,16443805,
2550,16446374,2530,16448924,2510,16451454,2492,16453964,2472,16456456,
2454,16458928,2435,16461382,2416,16463817,2398,16466233,2379,16468631,
2362,16471010,2343,16473372,2325,16475715,2308,16478040,2290,16480348,
2272,16482638,2256,16484910,2237,16487166,2221,16489403,2204,16491624,
2187,16493828,2170,16496015,2153,16498185,2137,16500338,2121,16502475,
2104,16504596,2089,16506700,2072,16508789,2057,16510861,2040,16512918,
2025,16514958,2010,16516983,1994,16518993,1979,16520987,1964,16522966,
1948,16524930,1934,16526878,1919,16528812,1904,16530731,1890,16532635,
1875,16534525,1861,16536400,1846,16538261,1832,16540107,1818,16541939,
1805,16543757,1790,16545562,1777,16547352,1763,16549129,1749,16550892,
1736,16552641,1723,16554377,1709,16556100,1697,16557809,1683,16559506,
1671,16561189,1657,16562860,1645,16564517,1632,16566162,1620,16567794,
1607,16569414,1595,16571021,1582,16572616,1571,16574198,1558,16575769,
1546,16577327,1535,16578873,1523,16580408,1511,16581931,1499,16583442,
1488,16584941,1476,16586429,1465,16587905,1454,16589370,1442,16590824,
1432,16592266,1420,16593698,1409,16595118,1399,16596527,1388,16597926,
1377,16599314,1367,16600691,1356,16602058,1345,16603414,1335,16604759,
1325,16606094,1315,16607419,1305,16608734,1294,16610039,1285,16611333,
1275,16612618,1264,16613893,1256,16615157,1245,16616413,1236,16617658,
1226,16618894,1217,16620120,1207,16621337,1199,16622544,1189,16623743,
1179,16624932,1171,16626111,1162,16627282,1152,16628444,1144,16629596,
1135,16630740,1126,16631875,1118,16633001,1108,16634119,1101,16635227,
1092,16636328,1083,16637420,1075,16638503,1067,16639578,1058,16640645,
1051,16641703,1042,16642754,1034,16643796,1026,16644830,1019,16645856,
1010,16646875,1003,16647885,994,16648888,988,16649882,979,16650870,
972,16651849,965,16652821,957,16653786,949,16654743,943,16655692,
935,16656635,928,16657570,920,16658498,914,16659418,906,16660332,
900,16661238,892,16662138,886,16663030,878,16663916,872,16664794,
866,16665666,858,16666532,852,16667390,845,16668242,839,16669087,
832,16669926,826,16670758,820,16671584,813,16672404,807,16673217,
800,16674024,795,16674824,788,16675619,782,16676407,776,16677189,
770,16677965,765,16678735,758,16679500,752,16680258,747,16681010,
740,16681757,735,16682497,730,16683232,724,16683962,718,16684686,
712,16685404,707,16686116,702,16686823,696,16687525,691,16688221,
685,16688912,680,16689597,675,16690277,670,16690952,664,16691622,
659,16692286,654,16692945,650,16693599,644,16694249,639,16694893,
634,16695532,629,16696166,624,16696795,620,16697419,615,16698039,
610,16698654,605,16699264,600,16699869,596,16700469,592,16701065,
586,16701657,582,16702243,578,16702825,573,16703403,569,16703976,
564,16704545,560,16705109,556,16705669,551,16706225,547,16706776,
543,16707323,538,16707866,535,16708404,530,16708939,526,16709469,
522,16709995,518,16710517,514,16711035,510,16711549,507,16712059,
502,16712566,498,16713068,494,16713566,491,16714060,487,16714551,
483,16715038,479,16715521,475,16716000,472,16716475,468,16716947,
465,16717415,461,16717880,457,16718341,454,16718798,450,16719252,
447,16719702,444,16720149,439,16720593,437,16721032,433,16721469,
430,16721902,426,16722332,423,16722758,420,16723181,417,16723601,
413,16724018,410,16724431,407,16724841,404,16725248,401,16725652,
397,16726053,395,16726450,391,16726845,388,16727236,386,16727624,
382,16728010,380,16728392,376,16728772,374,16729148,370,16729522,
368,16729892,365,16730260,362,16730625,359,16730987,357,16731346,
353,16731703,351,16732056,349,16732407,345,16732756,343,16733101,
340,16733444,338,16733784,335,16734122,332,16734457,330,16734789,
327,16735119,325,16735446,322,16735771,319,16736093,318,16736412,
314,16736730,313,16737044,309,16737357,308,16737666,305,16737974,
302,16738279,301,16738581,298,16738882,295,16739180,294,16739475,
291,16739769,289,16740060,286,16740349,285,16740635,282,16740920,
280,16741202,278,16741482,275,16741760,274,16742035,271,16742309,
269,16742580,268,16742849,265,16743117,263,16743382,261,16743645,
259,16743906,257,16744165,255,16744422,253,16744677,251,16744930,
249,16745181,247,16745430,245,16745677,243,16745922,242,16746165,
239,16746407,238,16746646,236,16746884,234,16747120,232,16747354,
230,16747586,229,16747816,227,16748045,225,16748272,223,16748497,
222,16748720,219,16748942,219,16749161,216,16749380,215,16749596,
213,16749811,211,16750024,210,16750235,208,16750445,207,16750653,
205,16750860,203,16751065,202,16751268,200,16751470,199,16751670,
197,16751869,195,16752066,195,16752261,192,16752456,191,16752648,
190,16752839,188,16753029,186,16753217,186,16753403,183,16753589,
183,16753772,181,16753955,179,16754136,178,16754315,177,16754493,
175,16754670,174,16754845,173,16755019,171,16755192,170,16755363,
169,16755533,167,16755702,166,16755869,165,16756035,163,16756200,
162,16756363,161,16756525,160,16756686,158,16756846,158,16757004,
156,16757162,154,16757318,154,16757472,152,16757626,151,16757778,
150,16757929,149,16758079,148,16758228,146,16758376,146,16758522,
144,16758668,143,16758812,142,16758955,141,16759097,140,16759238,
139,16759378,137,16759517,137,16759654,136,16759791,134,16759927,
133,16760061,133,16760194,131,16760327,131,16760458,129,16760589,
128,16760718,128,16760846,126,16760974,125,16761100,125,16761225,
123,16761350,123,16761473,121,16761596,121,16761717,119,16761838,
119,16761957,118,16762076,117,16762194,115,16762311,115,16762426,
115,16762541,113,16762656,112,16762769,112,16762881,110,16762993,
110,16763103,109,16763213,108,16763322,107,16763430,107,16763537,
105,16763644,105,16763749,104,16763854,103,16763958,103,16764061,
101,16764164,101,16764265,100,16764366,99,16764466,98,16764565,
98,16764663,97,16764761,96,16764858,95,16764954,95,16765049,
94,16765144,93,16765238,93,16765331,91,16765424,91,16765515,
91,16765606,89,16765697,89,16765786,89,16765875};

